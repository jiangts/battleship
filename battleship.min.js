(function(){var a;a=function(){function a(a,b){this.width=a,this.height=b,this.board={},this.pieces=[]}return a.prototype.contains=function(a,b){return a>=1&&a<=this.width&&b>=1&&b<=this.height},a.prototype.containsCell=function(a){var b,c,d;return d=a.split(","),b=d[0],c=d[1],this.contains(b,c)},a.prototype.toCell=function(a,b){return""+a+","+b},a.prototype.setCell=function(a,b,c){return this.contains(a,b)?this.board[this.toCell(a,b)]=c:void 0},a.prototype.shootCell=function(a,b){return this.setCell(a,b,this.cellHasPiece(this.toCell(a,b)))},a.prototype.cellHasPiece=function(a){var b,c,d,e;for(e=this.pieces,c=0,d=e.length;d>c;c++)if(b=e[c],b.containsCell(a))return!0;return!1},a.prototype.addPiece=function(a){var b;for(b in a.cells)if(!this.containsCell(b)||this.cellHasPiece(b))return!1;return this.pieces.push(a),!0},a.prototype.checkLoss=function(){var a,b,c,d;for(d=this.pieces,b=0,c=d.length;c>b;b++)if(a=d[b],!a.isDead())return!1;return!0},a}(),window.Board=a}).call(this),function(){var a,b,c,d={}.hasOwnProperty,e=function(a,b){function c(){this.constructor=a}for(var e in b)d.call(b,e)&&(a[e]=b[e]);return c.prototype=b.prototype,a.prototype=new c,a.__super__=b.prototype,a};a=function(){function a(a,b){this.length=a,this.horizontal=null!=b?b:!0,this.cells={}}return a.prototype.isDead=function(){var a,b,c,d,e;for(e=this.cells,b=c=0,d=e.length;d>c;b=++c)if(a=e[b],!b)return!1;return!0},a.prototype.flip=function(){return this.horizontal=!this.horizontal},a.prototype.toCell=function(a,b){return""+a+","+b},a.prototype.contains=function(a,b){return this.toCell(a,b)in this.cells},a.prototype.containsCell=function(a){var b,c,d;return d=a.split(","),b=d[0],c=d[1],this.contains(b,c)},a.prototype.place=function(a,b){var c,d,e,f;for(f=[],c=d=1,e=this.length;e>=1?e>=d:d>=e;c=e>=1?++d:--d)this.cells[this.toCell(a,b)]=!1,f.push(this.horizontal?a++:b++);return f},a.prototype.remove=function(){return this.cells=[]},a}(),c={"Aircraft Carrier":5,Battleship:4,Submarine:3,Cruiser:3,Destroyer:2},b=function(a){function b(a,d){null==d&&(d=!0),b.__super__.constructor.call(this,c[a],d)}return e(b,a),b}(a),window.Ship=b}.call(this),function(){var a,b,c;a=function(){function a(a,b,c){this.pieceArr=a,this.x=b,this.y=c,this.board=new Board(this.x,this.y)}return a.prototype.setOpponent=function(a){this.opponent=a},a.prototype.placePiece=function(a,b,c){var d;return d=new Ship(this.pieceArr.slice(-1),a),d.place(b,c),this.board.addPiece(d)?(console.log("Just placed a "+this.pieceArr.slice(-1)+" at ("+b+", "+c+")!"),this.pieceArr.pop()):!1},a.prototype.attackCoord=function(a,b){return this.opponent?this.opponent.board.shootCell(a,b):void 0},a.prototype.cpuSetup=function(){var a,d;for(a=0,d=[];this.pieceArr.length>0&&a++<100;)d.push(this.placePiece(b(),c(1,this.x),c(1,this.y)));return d},a}(),c=function(a,b){return Math.floor(Math.random()*(b-a+1))+a},b=function(){return Math.random()>.5},window.Player=a}.call(this),function(){var a;a=function(){function a(a,b){this.div=a,this.config=null!=b?b:{x:10,y:10,ships:["Aircraft Carrier","Battleship","Submarine","Cruiser","Destroyer"]},this.turn=0,this.p1=new Player(this.config.ships,this.config.x,this.config.y),this.p2=new Player(this.config.ships,this.config.x,this.config.y)}return a.prototype.setup=function(){return this.p2.cpuSetup(),this.createBoardUI("attack-board",this.p2.board,this.handleCellClick)},a.prototype.myTurn=function(){return this.turn&!1},a.prototype.createBoardUI=function(a,b,c){return $(function(d){return function(){var e,f,g,h,i,j,k,l,m;for(i=$("<table class='"+a+"'>"),f=j=1,l=d.config.x;l>=1?l>=j:j>=l;f=l>=1?++j:--j){for(h=$("<tr class='"+f+"'></tr>"),g=k=1,m=d.config.y;m>=1?m>=k:k>=m;g=m>=1?++k:--k)e=$("<td class='"+g+","+f+"'></td>"),h.append(e),e.click(function(){return c($(this),b)});i.append(h)}return $(d.div).append(i)}}(this))},a.prototype.handleCellClick=function(a,b){var c,d,e,f;return c=a.attr("class"),f=c.split(","),d=f[0],e=f[1],window.me=a,b.shootCell(d,e)?("rgb(255, 0, 0)"!==a.css("background-color")&&console.log("HIT!"),a.css("background-color","red"),b.checkLoss()===!0?alert("Congratulations, player X wins!"):void 0):a.css("background-color","yellow")},a}(),window.Game=a,window.game=new a("#battleship-game"),game.setup()}.call(this);